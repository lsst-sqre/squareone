import { describe, it, expect } from 'vitest';
import { render, screen } from '@testing-library/react';
import <%= ComponentName %>, { <%= ComponentName %>Inner } from './<%= ComponentName %>';
import { <%= ProviderName %> } from './<%= ComponentName %>Context';

describe('<%= ComponentName %>', () => {
  it('renders children with built-in provider', () => {
    render(<<%= ComponentName %>>Test content</<%= ComponentName %>>);
    expect(screen.getByText('Test content')).toBeInTheDocument();
  });

  it('renders children with external provider', () => {
    render(
      <<%= ProviderName %>>
        <<%= ComponentName %>Inner>Test content</<%= ComponentName %>Inner>
      </<%= ProviderName %>>
    );
    expect(screen.getByText('Test content')).toBeInTheDocument();
  });

  it('applies custom className', () => {
    const { container } = render(
      <<%= ComponentName %> className="custom-class">Content</<%= ComponentName %>>
    );
    expect(container.querySelector('.custom-class')).toBeInTheDocument();
  });
});

describe('<%= ComponentName %>Inner', () => {
  it('throws error when used outside provider', () => {
    // Suppress console.error for this test
    const consoleSpy = vi.spyOn(console, 'error').mockImplementation(() => {});

    expect(() => {
      render(<<%= ComponentName %>Inner>Content</<%= ComponentName %>Inner>);
    }).toThrow('use<%= baseName %> must be used within a <%= ProviderName %>');

    consoleSpy.mockRestore();
  });
});
